{% extends "base.html" %}
{% block content %}

<h3 class="mb-4">‚≠ê Sharhlar (AI transcript + AI xulosa)</h3>

<div class="card shadow-sm mb-4">
    <div class="card-body">

        <form method="GET" class="row">

            <div class="col-md-4">
                <select name="type" class="form-select">
                    <option value="">Hammasi</option>
                    <option value="client">Foydalanuvchi reviewlari</option>
                    <option value="master">Usta hisobotlari</option>
                </select>
            </div>

            <div class="col-md-2">
                <button class="btn btn-dark w-100">Filter</button>
            </div>

        </form>

    </div>
</div>


<div class="card shadow-sm">
    <div class="card-body">

        {% if reviews %}
        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>Buyurtma</th>
                <th>Turi</th>
                <th>Transcript</th>
                <th>AI xulosa</th>
                <th>Sifat</th>
                <th>Sentiment</th>
                <th>Sana</th>
            </tr>
            </thead>

            <tbody>
            {% for r in reviews %}
            <tr>
                <td>{{ r.id }}</td>
                <td>#{{ r.order_id }}</td>

                <td>
                    {% if r.audio_type == "client" %}
                        üéß Mijoz
                    {% else %}
                        üßë‚Äçüîß Usta
                    {% endif %}
                </td>

                <td>{{ r.transcript[:40] }}...</td>
                <td>{{ r.ai_summary[:40] }}...</td>

                <td>{{ r.quality_score }}/100</td>
                <td>{{ r.sentiment_score }}/100</td>

                <td>{{ r.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>

        {% else %}
            <p class="text-muted">Hozircha sharhlar mavjud emas.</p>
        {% endif %}

    </div>
</div>

{% endblock %}
