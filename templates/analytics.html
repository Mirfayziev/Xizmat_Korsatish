{% extends "base.html" %}
{% block content %}

<h3 class="mb-4">ðŸ“ˆ Analitika paneli</h3>

<div class="row">

    <!-- KPI CARDS -->
    <div class="col-md-3">
        <div class="card shadow-sm mb-3">
            <div class="card-body">
                <h6>Jami buyurtmalar</h6>
                <h2>{{ total_orders }}</h2>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card shadow-sm mb-3">
            <div class="card-body">
                <h6>Tugagan buyurtmalar</h6>
                <h2>{{ done_orders }}</h2>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card shadow-sm mb-3">
            <div class="card-body">
                <h6>Daromad (Jami)</h6>
                <h2>{{ revenue }} soâ€˜m</h2>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card shadow-sm mb-3">
            <div class="card-body">
                <h6>Profit (Platforma foydasi)</h6>
                <h2>{{ profit }} soâ€˜m</h2>
            </div>
        </div>
    </div>

</div>


<!-- TOP XIZMATLAR -->
<div class="card shadow-sm mb-4">
    <div class="card-body">

        <h5 class="mb-3">ðŸ”¥ Eng koâ€˜p buyurtma olingan xizmatlar</h5>

        <table class="table">
            <thead>
            <tr>
                <th>Xizmat</th>
                <th>Buyurtmalar soni</th>
            </tr>
            </thead>

            <tbody>
            {% for name, cnt in top_services %}
            <tr>
                <td>{{ name }}</td>
                <td>{{ cnt }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>

    </div>
</div>


<!-- GRAPH SECTION -->
<div class="card shadow-sm">
    <div class="card-body">
        <h5 class="mb-3">ðŸ“Š Grafiklar</h5>

        <canvas id="ordersChart" style="height:300px;"></canvas>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

    const ctx = document.getElementById('ordersChart').getContext('2d');

    // Dummy chart â€“ keyinchalik charts.js dan keladi
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ["Xizmat 1", "Xizmat 2", "Xizmat 3"],
            datasets: [{
                label: "Buyurtmalar soni",
                data: [10, 5, 8],
                borderWidth: 1
            }]
        }
    });

});
</script>

{% endblock %}
